appId: com.twelvelabs.strands-agent
productName: Strands Agent
directories:
  buildResources: build
files:
  - '!**/.vscode/*'
  - '!src/*'
  - '!electron.vite.config.{js,ts,mjs,cjs}'
  - '!{.eslintcache,eslint.config.mjs,.prettierignore,.prettierrc.yaml,dev-app-update.yml,CHANGELOG.md,README.md}'
  - '!{.env,.env.*,.npmrc,pnpm-lock.yaml}'
asarUnpack:
  - resources/**
  - "**/node_modules/@ffmpeg-installer/**/*"
  - "**/node_modules/@ffmpeg-installer/win32-x64/**/*"
  - "**/node_modules/@ffmpeg-installer/win32-ia32/**/*"
  - "**/node_modules/@ffmpeg-installer/darwin-x64/**/*"
  - "**/node_modules/@ffmpeg-installer/darwin-arm64/**/*"
  - "**/node_modules/@ffmpeg-installer/linux-x64/**/*"
win:
  target:
    - target: nsis
      arch:
        - x64
        - ia32
  icon: build/icon.ico  # Keep using .ico format for Windows (you can replace this file with TwelveLabs logo converted to .ico)
  publisherName: TwelveLabs
  # Completely disable code signing to prevent winCodeSign download
  sign: null
  verifyUpdateCodeSignature: false
  signingHashAlgorithms: []  # Empty array prevents signing tool download
nsis:
  artifactName: ${productName}-${version}-setup.${ext}
  shortcutName: ${productName}
  uninstallDisplayName: ${productName}
  createDesktopShortcut: always
  oneClick: false
  allowToChangeInstallationDirectory: true
mac:
  category: public.app-category.productivity
  target:
    - target: dmg
      arch:
        - x64
        - arm64
  icon: build/icon.icns  # Keep using .icns format for macOS (you can replace this file with TwelveLabs logo converted to .icns)
  entitlementsInherit: build/entitlements.mac.plist
  hardenedRuntime: true
  gatekeeperAssess: false
  extendInfo:
    - NSCameraUsageDescription: Application requests access to the device's camera.
    - NSMicrophoneUsageDescription: Application requests access to the device's microphone.
    - NSDocumentsFolderUsageDescription: Application requests access to the user's Documents folder.
    - NSDownloadsFolderUsageDescription: Application requests access to the user's Downloads folder.
  # Notarization is handled via environment variables (APPLE_ID, APPLE_APP_SPECIFIC_PASSWORD, APPLE_TEAM_ID)
  # electron-builder will automatically notarize if these are set and code signing is enabled
dmg:
  artifactName: ${productName}-${version}.${ext}
  title: ${productName} ${version}
  icon: build/icon.icns
  # Disable DMG window customization to avoid Perl module dependency (Mac::Finder::DSStore)
  # This prevents DMG customization errors on GitHub Actions macOS runners
  window: null
  background: null
linux:
  target:
    - AppImage
    - snap
    - deb
  maintainer: electronjs.org
  category: Utility
appImage:
  artifactName: ${name}-${version}.${ext}
npmRebuild: false

# Environment variables for production builds
# Set these before building:
# - APPLE_ID, APPLE_APP_SPECIFIC_PASSWORD, APPLE_TEAM_ID (for macOS notarization)
# - CERTIFICATE_FILE, CERTIFICATE_PASSWORD (for Windows code signing)

publish:
  provider: generic
  url: https://example.com/auto-updates
  # For auto-updates, configure your update server URL above

electronDownload:
  mirror: https://npmmirror.com/mirrors/electron/

# Completely disable code signing to avoid Windows symlink permission issues
# The error occurs because winCodeSign extraction requires admin privileges for symlinks
# Setting CSC_LINK to empty string prevents electron-builder from downloading signing tools
forceCodeSigning: false

# Compression and optimization
compression: maximum